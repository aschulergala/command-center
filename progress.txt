# GalaChain Command Center - Progress Log

## Learnings Section
(Patterns discovered, gotchas encountered, useful context for future iterations)
- NestJS project structure: src/ for backend, client/ for Vue, shared/ for types
- Use @nestjs/serve-static to serve Vue build from dist/client
- TypeScript paths configured for @shared/* imports
- nest-cli.json required for nest build command
- path-to-regexp v8+ syntax: use '/api{/*path}' not '/api/(.*)'
- Use SpaFallbackController with @Get('*path') for SPA fallback since ServeStaticModule doesn't handle it
- __dirname resolves to src/ in dev and dist/src/ in production - use relative paths accordingly

---

## Iteration 1 - project-setup
- What was implemented:
  - Initialized npm project with package.json
  - Installed NestJS core dependencies (@nestjs/common, core, platform-express, config, serve-static)
  - Created src/main.ts with NestJS bootstrap, CORS, validation pipe
  - Created src/app.module.ts with ConfigModule and ServeStaticModule
  - Created shared/ folder with types/wallet.ts placeholder
  - Created client/ folder with placeholder package.json
  - Created .gitignore for node_modules, dist, .env files
  - Created nest-cli.json and tsconfig.json
- Files changed:
  - package.json (new)
  - tsconfig.json (new)
  - nest-cli.json (new)
  - src/main.ts (new)
  - src/app.module.ts (new)
  - shared/index.ts (new)
  - shared/types/wallet.ts (new)
  - client/package.json (new)
  - .gitignore (new)
- GalaChain tools used: None (basic project setup)
- Tests: TypeScript typecheck passes, NestJS build passes
---

## Iteration 2 - vue-client-setup
- What was implemented:
  - Initialized Vite + Vue 3 + TypeScript in client/ folder
  - Installed Vue Router for client-side routing with routes: /tokens, /nfts, /creators, /export
  - Installed and configured Pinia for state management
  - Installed and configured Tailwind CSS with GalaChain brand colors
  - Installed @gala-chain/connect and @gala-chain/api packages
  - Installed VeeValidate + @vee-validate/zod for form validation
  - Installed @vueuse/core for Vue composition utilities
  - Installed axios for HTTP requests to backend API
  - Configured vite.config.ts: output to ../dist/client, proxy /api to NestJS in dev
  - Created folder structure: src/views/, src/components/, src/composables/, src/stores/, src/lib/
  - Configured path alias @ pointing to client/src/
  - Created placeholder views for all routes
  - Created style.css with Tailwind directives and custom component classes
- Files changed:
  - client/package.json (updated with full dependencies)
  - client/vite.config.ts (new)
  - client/tsconfig.json (new)
  - client/tsconfig.node.json (new)
  - client/index.html (new)
  - client/tailwind.config.js (new)
  - client/postcss.config.js (new)
  - client/.env (new)
  - client/src/main.ts (new)
  - client/src/App.vue (new)
  - client/src/style.css (new)
  - client/src/vite-env.d.ts (new)
  - client/src/router/index.ts (new)
  - client/src/lib/config.ts (new)
  - client/src/views/TokensView.vue (new)
  - client/src/views/NFTsView.vue (new)
  - client/src/views/CreatorsView.vue (new)
  - client/src/views/ExportView.vue (new)
  - package.json (updated test and typecheck scripts)
- GalaChain tools used: None (Vue setup)
- Tests: TypeScript compiles without errors, Vite build succeeds
- Learnings for future iterations:
  - Tailwind CSS brand colors defined as 'gala' namespace (gala-primary, gala-secondary, etc.)
  - Custom component classes (btn-primary, card, input) available in style.css
  - Path alias @ maps to client/src/ for clean imports
  - Pinia v3 used with Vue 3.5+
---

## Iteration 3 - nestjs-static-serving
- What was implemented:
  - Configured ServeStaticModule in app.module.ts to serve Vue build from dist/client
  - Created SpaFallbackController with wildcard route for SPA fallback
  - Fixed exclude pattern for new path-to-regexp syntax: '/api{/*path}'
  - Created AppController with health endpoint at GET /api/health
  - Set up Jest with ts-jest for server tests
  - Created unit tests for AppController
  - Created integration tests for static serving (spawns actual server process)
- Files changed:
  - src/app.module.ts (updated)
  - src/app.controller.ts (new)
  - src/spa-fallback.controller.ts (new)
  - src/__tests__/app.controller.spec.ts (new)
  - src/__tests__/app.e2e.spec.ts (new)
  - src/__tests__/static-serving.integration.spec.ts (new)
  - jest.config.js (new)
  - package.json (added Jest dependencies)
- GalaChain tools used: None (infrastructure setup)
- Tests: All 8 tests pass (3 unit, 1 e2e, 4 integration)
- Learnings for future iterations:
  - path-to-regexp v8+ syntax changed: use '/api{/*path}' instead of '/api/(.*)'
  - __dirname in NestJS changes between dev (src/) and production (dist/src/)
  - Use join(__dirname, '..', 'client') to resolve correctly in both contexts
  - ServeStaticModule doesn't have built-in SPA fallback - use a wildcard controller
  - Integration tests can spawn the actual server to test production behavior
  - Jest forceExit: true helps with child process cleanup
---

