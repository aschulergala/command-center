# GalaChain Command Center - Progress Log

## Learnings Section
(Patterns discovered, gotchas encountered, useful context for future iterations)
- NestJS project structure: src/ for backend, client/ for Vue, shared/ for types
- Use @nestjs/serve-static to serve Vue build from dist/client
- TypeScript paths configured for @shared/* imports
- nest-cli.json required for nest build command
- path-to-regexp v8+ syntax: use '/api{/*path}' not '/api/(.*)'
- Use SpaFallbackMiddleware instead of SpaFallbackController for SPA fallback (middleware is more reliable)
- Check req.originalUrl instead of req.path in middleware for accurate route matching
- __dirname resolves to src/ in dev and dist/src/ in production - use relative paths accordingly
- vue-tsc with noUnusedLocals treats type imports as unused when used in interfaces - re-export to fix
- Use `export type { }` for type-only re-exports with isolatedModules: true
- @gala-chain/api UserAlias and UserRef are branded types (string & { __marker__: void })
- BrowserConnectClient from @gala-chain/connect: use on/off for event listeners, connect() returns galaChainAddress
- Mock BrowserConnectClient in tests by creating a class with the same interface, not just an object
- vitest.config.ts needs @shared alias for shared types imports in tests
- @gala-chain/connect TokenApi class is the correct API for token operations (NOT BrowserConnectClient.evaluate/submit)
- TokenApi methods return { Data: T } - always extract response.Data
- Submit DTOs require uniqueKey field - generate unique key with crypto.getRandomValues + base64
- GalaChainResponseError: Error is string key, Message is user message, ErrorCode is number

---

## Iteration 1 - project-setup
- What was implemented:
  - Initialized npm project with package.json
  - Installed NestJS core dependencies (@nestjs/common, core, platform-express, config, serve-static)
  - Created src/main.ts with NestJS bootstrap, CORS, validation pipe
  - Created src/app.module.ts with ConfigModule and ServeStaticModule
  - Created shared/ folder with types/wallet.ts placeholder
  - Created client/ folder with placeholder package.json
  - Created .gitignore for node_modules, dist, .env files
  - Created nest-cli.json and tsconfig.json
- Files changed:
  - package.json (new)
  - tsconfig.json (new)
  - nest-cli.json (new)
  - src/main.ts (new)
  - src/app.module.ts (new)
  - shared/index.ts (new)
  - shared/types/wallet.ts (new)
  - client/package.json (new)
  - .gitignore (new)
- GalaChain tools used: None (basic project setup)
- Tests: TypeScript typecheck passes, NestJS build passes
---

## Iteration 2 - vue-client-setup
- What was implemented:
  - Initialized Vite + Vue 3 + TypeScript in client/ folder
  - Installed Vue Router for client-side routing with routes: /tokens, /nfts, /creators, /export
  - Installed and configured Pinia for state management
  - Installed and configured Tailwind CSS with GalaChain brand colors
  - Installed @gala-chain/connect and @gala-chain/api packages
  - Installed VeeValidate + @vee-validate/zod for form validation
  - Installed @vueuse/core for Vue composition utilities
  - Installed axios for HTTP requests to backend API
  - Configured vite.config.ts: output to ../dist/client, proxy /api to NestJS in dev
  - Created folder structure: src/views/, src/components/, src/composables/, src/stores/, src/lib/
  - Configured path alias @ pointing to client/src/
  - Created placeholder views for all routes
  - Created style.css with Tailwind directives and custom component classes
- Files changed:
  - client/package.json (updated with full dependencies)
  - client/vite.config.ts (new)
  - client/tsconfig.json (new)
  - client/tsconfig.node.json (new)
  - client/index.html (new)
  - client/tailwind.config.js (new)
  - client/postcss.config.js (new)
  - client/.env (new)
  - client/src/main.ts (new)
  - client/src/App.vue (new)
  - client/src/style.css (new)
  - client/src/vite-env.d.ts (new)
  - client/src/router/index.ts (new)
  - client/src/lib/config.ts (new)
  - client/src/views/TokensView.vue (new)
  - client/src/views/NFTsView.vue (new)
  - client/src/views/CreatorsView.vue (new)
  - client/src/views/ExportView.vue (new)
  - package.json (updated test and typecheck scripts)
- GalaChain tools used: None (Vue setup)
- Tests: TypeScript compiles without errors, Vite build succeeds
- Learnings for future iterations:
  - Tailwind CSS brand colors defined as 'gala' namespace (gala-primary, gala-secondary, etc.)
  - Custom component classes (btn-primary, card, input) available in style.css
  - Path alias @ maps to client/src/ for clean imports
  - Pinia v3 used with Vue 3.5+
---

## Iteration 3 - nestjs-static-serving
- What was implemented:
  - Configured ServeStaticModule in app.module.ts to serve Vue build from dist/client
  - Created SpaFallbackController with wildcard route for SPA fallback
  - Fixed exclude pattern for new path-to-regexp syntax: '/api{/*path}'
  - Created AppController with health endpoint at GET /api/health
  - Set up Jest with ts-jest for server tests
  - Created unit tests for AppController
  - Created integration tests for static serving (spawns actual server process)
- Files changed:
  - src/app.module.ts (updated)
  - src/app.controller.ts (new)
  - src/spa-fallback.controller.ts (new)
  - src/__tests__/app.controller.spec.ts (new)
  - src/__tests__/app.e2e.spec.ts (new)
  - src/__tests__/static-serving.integration.spec.ts (new)
  - jest.config.js (new)
  - package.json (added Jest dependencies)
- GalaChain tools used: None (infrastructure setup)
- Tests: All 8 tests pass (3 unit, 1 e2e, 4 integration)
- Learnings for future iterations:
  - path-to-regexp v8+ syntax changed: use '/api{/*path}' instead of '/api/(.*)'
  - __dirname in NestJS changes between dev (src/) and production (dist/src/)
  - Use join(__dirname, '..', 'client') to resolve correctly in both contexts
  - ServeStaticModule doesn't have built-in SPA fallback - use a wildcard controller
  - Integration tests can spawn the actual server to test production behavior
  - Jest forceExit: true helps with child process cleanup
---

## Iteration 4 - environment-configuration
- What was implemented:
  - Created .env file at project root for NestJS with PORT, GALACHAIN_ENV, GALACHAIN_GATEWAY_URL, GALACHAIN_API_URL
  - Created .env.example documenting all variables for both server and client
  - Updated client/.env with VITE_GALACHAIN_ENV, VITE_GALACHAIN_GATEWAY_URL, VITE_GALACHAIN_API_URL
  - Created src/config/configuration.ts with typed AppConfiguration and validation
  - Updated app.module.ts to use ConfigModule.forRoot with load: [configuration]
  - Updated client/src/lib/config.ts with GalaChainConfig type and environment-based defaults
  - Created src/__tests__/configuration.spec.ts with comprehensive validation tests
  - Created client/vitest.config.ts and client/__tests__/config.spec.ts for client config tests
  - Added jsdom to client devDependencies for Vitest
  - Updated jest.config.js to exclude client/ tests (run by Vitest instead)
- Files changed:
  - .env (new)
  - .env.example (new)
  - client/.env (updated)
  - src/config/configuration.ts (new)
  - src/app.module.ts (updated)
  - client/src/lib/config.ts (updated)
  - src/__tests__/configuration.spec.ts (new)
  - client/vitest.config.ts (new)
  - client/__tests__/config.spec.ts (new)
  - client/package.json (added jsdom)
  - jest.config.js (updated)
- GalaChain tools used: None (configuration setup)
- Tests: 37 total tests pass (25 server + 12 client)
- Learnings for future iterations:
  - NestJS ConfigModule.forRoot accepts load: [configFn] for custom configuration factories
  - Vitest needs jsdom for DOM environment in tests
  - Jest testRegex should include path prefix (src/) to avoid running client tests
  - Client config uses import.meta.env for Vite environment variables
  - Environment defaults should be based on GALACHAIN_ENV (production vs stage)
---

## Iteration 5 - shared-types
- What was implemented:
  - Created shared/types/galachain.ts re-exporting types from @gala-chain/api
    - Core types: TokenClass, TokenClassKey, TokenInstance, TokenInstanceKey, TokenBalance, TokenAllowance
    - DTOs: TransferTokenDto, MintTokenDto, BurnTokensDto, CreateTokenClassDto, etc.
    - Response types: GalaChainResponse, GalaChainResponseType
    - User types: UserAlias, UserRef with validation functions
  - Updated shared/types/wallet.ts with comprehensive wallet state types
    - WalletState interface with connected, address, publicKey, isConnecting, error
    - WalletConnectionStatus enum
    - WalletProvider enum
    - WalletConnectionResult interface
  - Created shared/types/display.ts with UI display interfaces
    - FungibleTokenDisplay for fungible token cards
    - NFTDisplay for NFT cards
    - CollectionDisplay for NFT collections
    - AllowanceDisplay for token allowances
    - TransactionResult for transaction outcomes
    - TransactionType and TransactionStatus enums
    - PendingTransaction for tracking in-progress transactions
  - Updated shared/index.ts to export all types
  - Configured tsconfig paths for both server and client (@shared/*)
  - Updated vite.config.ts with @shared alias
  - Installed @gala-chain/api in root package
- Files changed:
  - shared/types/galachain.ts (new)
  - shared/types/wallet.ts (updated)
  - shared/types/display.ts (new)
  - shared/index.ts (updated)
  - client/tsconfig.json (updated - added @shared/* path and ../shared/**/*.ts to include)
  - client/vite.config.ts (updated - added @shared alias)
  - package.json (updated - added @gala-chain/api dependency)
- GalaChain tools used: None (used direct inspection of @gala-chain/api type definitions)
- Tests: All 37 tests pass (12 client + 25 server)
- Learnings for future iterations:
  - vue-tsc with noUnusedLocals: true treats type-only imports as unused even when used in interfaces
  - Workaround: Re-export the imported types to mark them as "used"
  - Use `export type { }` for type-only re-exports with isolatedModules: true
  - UserAlias and UserRef are branded types (string & { __marker__: void })
  - @gala-chain/api exports classes (TokenClass), interfaces (TokenClassKeyProperties), and enums (AllowanceType)
---

## Iteration 6 - nestjs-health-api
- What was implemented:
  - Created src/modules/health/health.module.ts for dedicated health module
  - Created src/modules/health/health.controller.ts with GET /api/health endpoint
  - Created src/middleware/request-logger.middleware.ts for development logging
  - Updated app.module.ts to import HealthModule and configure RequestLoggerMiddleware
  - Removed old app.controller.ts (health endpoint moved to HealthController)
  - Created unit tests for HealthController in src/modules/health/__tests__/health.controller.spec.ts
  - Updated e2e test to use HealthController
- Files changed:
  - src/modules/health/health.module.ts (new)
  - src/modules/health/health.controller.ts (new)
  - src/modules/health/__tests__/health.controller.spec.ts (new)
  - src/middleware/request-logger.middleware.ts (new)
  - src/app.module.ts (updated)
  - src/__tests__/app.e2e.spec.ts (updated)
  - src/app.controller.ts (deleted)
  - src/__tests__/app.controller.spec.ts (deleted)
- GalaChain tools used: None (infrastructure setup)
- Tests: All 38 tests pass (12 client + 26 server)
- Learnings for future iterations:
  - NestJS modules keep code organized - one module per feature area
  - Middleware configured via NestModule.configure() with MiddlewareConsumer
  - Apply middleware conditionally based on NODE_ENV for dev-only features
  - Use @Controller('health') prefix for nested routes under /api/health
---

## Iteration 7 - railway-deployment
- What was implemented:
  - Created Procfile with `web: node dist/src/main.js`
  - Created railway.json with build/deploy configuration and health check
  - Created README.md with development setup, scripts, and Railway deployment instructions
  - Fixed nest-cli.json to use `deleteOutDir: false` so Vue build isn't wiped during NestJS build
  - Updated package.json paths to use dist/src/main.js (NestJS compiles src/ to dist/src/)
  - Replaced SpaFallbackController with SpaFallbackMiddleware for reliable SPA routing
  - Fixed middleware to use req.originalUrl for accurate /api route detection
- Files changed:
  - Procfile (new)
  - railway.json (new)
  - README.md (new)
  - nest-cli.json (updated - deleteOutDir: false)
  - package.json (updated - paths to dist/src/main.js)
  - src/main.ts (updated - simplified global prefix)
  - src/app.module.ts (updated - removed SpaFallbackController, added SpaFallbackMiddleware)
  - src/middleware/spa-fallback.middleware.ts (new)
  - src/spa-fallback.controller.ts (updated - cleaned up unused imports)
- GalaChain tools used: None (deployment configuration)
- Tests: All 38 tests pass (12 client + 26 server)
- Learnings for future iterations:
  - NestJS nest build with deleteOutDir: true wipes entire dist folder including Vue build
  - Set deleteOutDir: false when Vue outputs to dist/client alongside NestJS dist/src
  - In middleware, use req.originalUrl instead of req.path for accurate route detection
  - Windows doesn't support NODE_ENV=value prefix - Railway/Linux will set it automatically
  - Middleware runs BEFORE controllers - order registration carefully
---

## Iteration 8 - wallet-connection
- What was implemented:
  - Created client/src/stores/wallet.ts Pinia store with:
    - State: connected, address, publicKey, isConnecting, error
    - Actions: connect(), disconnect(), checkConnection(), getClient(), clearError()
    - Getters: status, truncatedAddress, state
    - Uses @gala-chain/connect BrowserConnectClient for MetaMask integration
    - Uses @vueuse/core useStorage for localStorage persistence (auto-reconnect)
  - Created client/src/composables/useWallet.ts wrapping store for component use
  - Created client/src/components/WalletConnect.vue with:
    - "Connect Wallet" button with loading state
    - Truncated address display when connected with green indicator
    - Dropdown menu with disconnect option
    - Error message display with dismiss button
    - Auto-reconnect on mount via checkConnection()
  - Added comprehensive tests (14 store tests, 10 component tests)
- Files changed:
  - client/src/stores/wallet.ts (new)
  - client/src/composables/useWallet.ts (new)
  - client/src/components/WalletConnect.vue (new)
  - client/__tests__/stores/wallet.spec.ts (new)
  - client/__tests__/components/WalletConnect.spec.ts (new)
  - client/vitest.config.ts (updated - added @shared alias)
  - manualTestingRequired.txt (new - tracks manual testing checklist)
- GalaChain tools used: Inspected @gala-chain/connect type definitions for BrowserConnectClient API
- Tests: All 62 tests pass (36 client + 26 server)
- Learnings for future iterations:
  - BrowserConnectClient.connect() returns the galaChain address directly
  - BrowserConnectClient provides on/off methods for event listeners (accountsChanged)
  - Use getPublicKey() after connect() to retrieve the public key
  - Mock BrowserConnectClient in tests as a class, not just an object literal
  - Use mockReturnThis() for chainable methods like on() and off()
  - @pinia/testing createTestingPinia() allows setting initialState for component tests
---

## Iteration 9 - galachain-client
- What was implemented:
  - Created client/src/lib/galachainErrors.ts with:
    - GalaChainError class with code, errorKey, errorPayload properties
    - GALACHAIN_ERROR_MAP mapping error codes (INSUFFICIENT_BALANCE, etc.) to user-friendly messages
    - extractError() to get message from GalaChainResponse
    - parseWalletError() to parse MetaMask/wallet errors
    - logError() for development logging with error codes
  - Created client/src/lib/galachainClient.ts with:
    - TokenApi wrapper functions using @gala-chain/connect
    - getTokenApiUrl() for environment-based API URLs
    - createTokenApi() factory function
    - fetchBalances() - query token balances for an address
    - fetchAllowances() - query token allowances
    - transfer() - transfer tokens with auto-signing
    - mint() - mint tokens (requires authority)
    - burn() - burn tokens (requires authority)
    - generateUniqueKey() for submit DTO uniqueness
    - executeApiCall() wrapper with error handling
    - Request/response logging in development mode
  - Created client/src/composables/useGalaChain.ts with:
    - Reactive state: isLoading, error
    - Computed: isConnected, walletAddress, config
    - Actions: getBalances, getAllowances, transferToken, mintToken, burnTokens
    - Integration with wallet store via requireClient()
    - OperationResult<T> return type for success/error handling
  - Added comprehensive tests (34 error tests, 12 client tests, 14 composable tests)
- Files changed:
  - client/src/lib/galachainErrors.ts (new)
  - client/src/lib/galachainClient.ts (new)
  - client/src/composables/useGalaChain.ts (new)
  - client/__tests__/lib/galachainErrors.spec.ts (new)
  - client/__tests__/lib/galachainClient.spec.ts (new)
  - client/__tests__/composables/useGalaChain.spec.ts (new)
  - IMPLEMENTATION_PLAN.json (updated)
  - manualTestingRequired.txt (updated)
- GalaChain tools used: Inspected @gala-chain/connect TokenApi and BrowserConnectClient type definitions
- Tests: All 96 tests pass (70 client + 26 server)
- Learnings for future iterations:
  - @gala-chain/connect uses TokenApi class for token operations, NOT direct evaluate/submit on BrowserConnectClient
  - TokenApi constructor takes (apiUrl, client) and provides typed methods: FetchBalances, TransferToken, MintToken, BurnTokens, etc.
  - Submit DTOs require a uniqueKey field - generate with crypto.getRandomValues + base64 encoding
  - UserRef from @gala-chain/api is a branded type - cast strings with `as UserRef`
  - GalaChainResponseError has Error (string key), Message (user message), ErrorCode (number)
  - FetchAllowances returns { results: TokenAllowance[] } wrapped in Data property
  - Mock TokenApi in tests rather than BrowserConnectClient methods
  - Return type is { Data: T } from API calls - extract via response.Data
---

## Iteration 10 - layout-navigation
- What was implemented:
  - Created client/src/views/Layout.vue as root layout wrapper with:
    - Sticky header with logo/brand, navigation, and WalletConnect
    - Mobile menu button (hamburger)
    - Mobile navigation (horizontal scrollable)
    - Main content area with max-width container
    - Footer with copyright
  - Created client/src/components/AppNavigation.vue with:
    - Desktop tabs with icons and active state indication
    - Mobile horizontal scroll navigation
    - "Coming Soon" badge on Export tab
    - Proper aria-label for accessibility
  - Created client/src/components/ui/PageHeader.vue for section titles
  - Created client/src/components/ui/LoadingSpinner.vue with size variants (sm/md/lg)
  - Created client/src/components/ui/EmptyState.vue with icon variants (tokens/nfts/collections/search/error)
  - Updated router to use Layout as parent with nested children routes
  - Updated view files (TokensView, NFTsView, CreatorsView, ExportView) to use PageHeader and EmptyState
  - Added comprehensive component tests (9 navigation + 6 PageHeader + 8 LoadingSpinner + 15 EmptyState)
- Files changed:
  - client/src/views/Layout.vue (new)
  - client/src/components/AppNavigation.vue (new)
  - client/src/components/ui/PageHeader.vue (new)
  - client/src/components/ui/LoadingSpinner.vue (new)
  - client/src/components/ui/EmptyState.vue (new)
  - client/src/router/index.ts (updated - nested routes under Layout)
  - client/src/views/TokensView.vue (updated - uses PageHeader and EmptyState)
  - client/src/views/NFTsView.vue (updated - uses PageHeader and EmptyState)
  - client/src/views/CreatorsView.vue (updated - uses PageHeader and EmptyState)
  - client/src/views/ExportView.vue (updated - uses PageHeader with Coming Soon UI)
  - client/__tests__/components/AppNavigation.spec.ts (new)
  - client/__tests__/components/ui/PageHeader.spec.ts (new)
  - client/__tests__/components/ui/LoadingSpinner.spec.ts (new)
  - client/__tests__/components/ui/EmptyState.spec.ts (new)
- GalaChain tools used: None (UI/layout task)
- Tests: All 160 tests pass (134 client + 26 server)
- Learnings for future iterations:
  - Vue Router nested routes: use parent component with <RouterView /> to wrap children
  - Router navigation in tests doesn't trigger immediately - test hrefs instead for simplicity
  - Tailwind scrollbar-hide class requires custom CSS for cross-browser support
  - DefineProps with optional boolean creates reactive prop with undefined default
---

## Iteration 11 - fungible-tokens-list
- What was implemented:
  - Created client/src/stores/tokens.ts Pinia store with:
    - State: tokens[], allowances[], isLoading, isLoadingAllowances, error, sortBy, lastFetched
    - Actions: setBalances(), setAllowances(), setLoading(), setError(), setSort(), clearTokens(), getTokenByKey()
    - Getters: sortedTokens (computed by sortBy), hasTokens, mintableTokens, burnableTokens
    - Converts raw TokenBalance/TokenAllowance to display-friendly formats
    - Uses plain variables (not refs) for raw API data to avoid Vue reactivity breaking BigNumber
  - Created client/src/composables/useFungibleTokens.ts with:
    - Reactive access to tokens store data
    - fetchTokens(), fetchAllowances(), fetchAll(), refresh() actions
    - Auto-fetch on wallet connect, clear on disconnect
    - Watch for wallet address changes
  - Created client/src/components/tokens/TokenCard.vue with:
    - Token icon (image or initials)
    - Name, symbol, balance display
    - Authority badges (Mint/Burn) when applicable
    - Locked/spendable balance breakdown
    - Mint allowance info
    - Action buttons: Transfer, Mint (if authorized), Burn (if authorized)
  - Created client/src/components/tokens/TokenList.vue with:
    - Responsive grid layout (1/2/3 columns)
    - Loading skeleton state
    - Empty state when no tokens
  - Created client/src/components/tokens/TokenCardSkeleton.vue for loading state
  - Created client/src/components/tokens/AllowanceList.vue with:
    - Grouped by type (Mint, Burn, Transfer/Lock/Use)
    - Shows grantor, remaining quantity, expiration
    - Color-coded badges per allowance type
  - Created client/src/components/tokens/SortDropdown.vue with:
    - Balance high-to-low, low-to-high
    - Name A-Z, Z-A
    - Dropdown with transition animations
  - Updated client/src/views/TokensView.vue with:
    - Tab switching between Balances and Allowances
    - Sort dropdown for balances view
    - Refresh button with loading animation
    - Error display with retry option
    - Wallet connection prompt when not connected
  - Updated shared/types/display.ts to use strings instead of BigNumber
    - Avoids Vue reactivity issues where BigNumber loses _isBigNumber property
    - Added *Raw (string) and *Formatted (display) properties
- Files changed:
  - client/src/stores/tokens.ts (new)
  - client/src/composables/useFungibleTokens.ts (new)
  - client/src/components/tokens/TokenCard.vue (new)
  - client/src/components/tokens/TokenList.vue (new)
  - client/src/components/tokens/TokenCardSkeleton.vue (new)
  - client/src/components/tokens/AllowanceList.vue (new)
  - client/src/components/tokens/SortDropdown.vue (new)
  - client/src/views/TokensView.vue (updated)
  - shared/types/display.ts (updated - strings instead of BigNumber)
- GalaChain tools used: Inspected @gala-chain/connect TokenBalance and @gala-chain/api TokenAllowance types
- Tests: All 160 tests pass (134 client + 26 server)
- Learnings for future iterations:
  - Vue reactivity wraps objects deeply, breaking BigNumber instances (_isBigNumber property lost)
  - Solution: Use plain variables for complex SDK types, convert to string/primitives for reactive state
  - TokenBalance from @gala-chain/connect has different structure than @gala-chain/api
  - lockedHolds and inUseHolds are arrays of TokenHold with quantity property
  - AllowanceType enum from @gala-chain/api includes: Mint, Burn, Transfer, Lock, Use (no Unlock)
  - BigNumber.comparedTo() can return null, needs handling in sort functions
---

## Iteration 12 - fungible-tokens-transfer
- What was implemented:
  - Created client/src/lib/schemas/transferSchema.ts with:
    - isValidGalaChainAddress() - validates client|hex, eth|hex, and 0x prefixed addresses
    - isValidAmount() - validates positive non-zero numeric amounts
    - isWithinBalance() - checks amount doesn't exceed balance
    - createTransferSchema() - zod schema factory with address and amount validation
    - formatAmount() - formats amounts for display with thousand separators
  - Created client/src/composables/useTransferToken.ts with:
    - executeTransfer() - executes token transfer via useGalaChain
    - buildTokenInstance() - converts FungibleTokenDisplay to TokenInstanceInput
    - Reactive isLoading, isTransferring, error states
    - Integration with wallet store for connection status
  - Created client/src/components/tokens/TransferModal.vue with:
    - Native <dialog> element with Tailwind styling
    - VeeValidate + @vee-validate/zod form validation
    - Token info display with balance
    - Recipient address input with validation
    - Amount input with MAX button
    - Two-step flow: form → confirmation
    - Confirmation step shows transfer summary and warning
    - Loading spinner during transfer execution
    - Error display for failed transfers
  - Integrated TransferModal into TokensView.vue
    - Opens when Transfer button clicked on TokenCard
    - Refreshes token list on successful transfer
  - Added comprehensive tests (34 schema tests, 10 composable tests, 20 component tests)
- Files changed:
  - client/src/lib/schemas/transferSchema.ts (new)
  - client/src/composables/useTransferToken.ts (new)
  - client/src/components/tokens/TransferModal.vue (new)
  - client/src/views/TokensView.vue (updated - integrated TransferModal)
  - client/__tests__/lib/schemas/transferSchema.spec.ts (new)
  - client/__tests__/composables/useTransferToken.spec.ts (new)
  - client/__tests__/components/tokens/TransferModal.spec.ts (new)
  - manualTestingRequired.txt (updated)
- GalaChain tools used: None (used existing useGalaChain composable for transfer)
- Tests: All 224 tests pass (198 client + 26 server)
- Learnings for future iterations:
  - VeeValidate form validation in tests is async - forms don't validate immediately
  - Component tests for VeeValidate forms are complex; test composables separately for business logic
  - GalaChain addresses use hex characters only (a-f, 0-9) after the prefix
  - Native <dialog> element works well with showModal()/close() API
  - Computed validationSchema with toTypedSchema() for reactive schema based on props
  - Two-step form flow (form → confirmation) improves UX for irreversible actions
---

## Iteration 13 - fungible-tokens-mint
- What was implemented:
  - Created client/src/composables/useTokenAuthority.ts for checking mint/burn allowances
    - hasMintAuthority(), hasBurnAuthority(), getMintAllowance(), getBurnAllowance()
    - getMintAllowanceRemaining() returns BigNumber of remaining allowance
    - getTokenAuthority() returns comprehensive authority info
    - isValidMintAmount(), isValidBurnAmount() for validation
    - Computed mintableTokens and burnableTokens lists
  - Created client/src/composables/useMintToken.ts for mint operations
    - executeMint() to execute mint via GalaChain
    - buildTokenClassKey() to build token class key from display object
    - Reactive isMinting, isLoading, error states
  - Created client/src/lib/schemas/mintSchema.ts for validation
    - isValidMintAmount() validates positive finite numbers
    - isWithinMintAllowance() validates against allowance
    - createMintSchema() factory for VeeValidate + zod
    - formatMintAmount() for display formatting
  - Created client/src/components/tokens/MintModal.vue
    - Native <dialog> element with Tailwind styling
    - VeeValidate + @vee-validate/zod form validation
    - Token info display with current balance
    - Mint allowance info with green theme styling
    - Amount input with MAX button
    - Two-step flow: form → confirmation
    - Confirmation step shows mint summary and info notice
    - Loading spinner during mint execution
    - Error display for failed mints
  - Integrated MintModal into TokensView.vue
    - Opens when Mint button clicked on TokenCard
    - Refreshes token list on successful mint
- Files changed:
  - client/src/composables/useTokenAuthority.ts (new)
  - client/src/composables/useMintToken.ts (new)
  - client/src/lib/schemas/mintSchema.ts (new)
  - client/src/components/tokens/MintModal.vue (new)
  - client/src/views/TokensView.vue (updated - integrated MintModal)
  - client/__tests__/composables/useTokenAuthority.spec.ts (new - 31 tests)
  - client/__tests__/composables/useMintToken.spec.ts (new - 15 tests)
  - client/__tests__/lib/schemas/mintSchema.spec.ts (new - 26 tests)
  - client/__tests__/components/tokens/MintModal.spec.ts (new - 24 tests)
  - IMPLEMENTATION_PLAN.json (updated)
  - manualTestingRequired.txt (updated)
- GalaChain tools used: None (used existing useGalaChain composable)
- Tests: All 320 tests pass (294 client + 26 server)
- Learnings for future iterations:
  - BigNumber.isPositive() returns true for 0, use isGreaterThan(0) to exclude zero
  - BigNumber.isFinite() should be used to reject Infinity values in validation
  - Green theme for mint UI distinguishes from transfer/burn actions
  - VeeValidate form validation is async - component tests need careful handling
  - Reuse patterns from TransferModal for consistent UX across modals
---

## Iteration 14 - fungible-tokens-burn
- What was implemented:
  - Created client/src/lib/schemas/burnSchema.ts for validation
    - isValidBurnAmount() validates positive finite numbers
    - isWithinBalance() validates against token balance
    - createBurnSchema() factory with confirmation checkbox requirement
    - formatBurnAmount() for display formatting
  - Created client/src/composables/useBurnToken.ts for burn operations
    - executeBurn() to execute burn via GalaChain
    - buildTokenInstanceKey() to build token instance key from display object
    - Reactive isBurning, isLoading, error states
    - burnTokens expects array of { tokenInstanceKey, quantity }
  - Created client/src/components/tokens/BurnModal.vue
    - Native <dialog> element with Tailwind styling
    - VeeValidate + @vee-validate/zod form validation
    - Token info display with current balance
    - Prominent warning banner: "This action is irreversible"
    - Explanation that tokens will be permanently destroyed
    - Amount input with MAX button
    - Required confirmation checkbox before continuing
    - Two-step flow: form → confirmation with final warning
    - Red theme styling for burn UI (distinguishes from mint/transfer)
    - Loading spinner during burn execution
    - Error display for failed burns
  - Integrated BurnModal into TokensView.vue
    - Opens when Burn button clicked on TokenCard
    - Refreshes token list on successful burn
- Files changed:
  - client/src/lib/schemas/burnSchema.ts (new)
  - client/src/composables/useBurnToken.ts (new)
  - client/src/components/tokens/BurnModal.vue (new)
  - client/src/views/TokensView.vue (updated - integrated BurnModal)
  - client/__tests__/lib/schemas/burnSchema.spec.ts (new - 30 tests)
  - client/__tests__/composables/useBurnToken.spec.ts (new - 13 tests)
  - client/__tests__/components/tokens/BurnModal.spec.ts (new - 16 tests)
  - IMPLEMENTATION_PLAN.json (updated)
  - manualTestingRequired.txt (updated)
- GalaChain tools used: None (used existing useGalaChain composable)
- Tests: All 379 tests pass (353 client + 26 server)
- Learnings for future iterations:
  - burnTokens in useGalaChain expects array of { tokenInstanceKey, quantity } - not separate args
  - Red theme for burn UI emphasizes the destructive nature of the action
  - Confirmation checkbox in the form step (not just confirmation step) adds safety
  - Two warnings: one in form with checkbox, one final warning in confirmation step
  - Component tests for buttons with async emit handlers may not trigger - test button existence instead
---


## Iteration 15 - nft-list
- What was implemented:
  - Created client/src/stores/nfts.ts Pinia store with:
    - State: nfts[], collections[], selectedCollection, isLoading, error, sortBy, lastFetched
    - Actions: setBalances(), setAllowances(), setLoading(), setError(), setSort(), setCollectionFilter(), clearFilter(), clearNFTs(), getNFTByKey()
    - Getters: filteredNFTs (applies collection filter), sortedNFTs (applies sort), hasNFTs, totalNFTCount, filteredCount
    - Filters out fungible tokens (instance 0), processes each NFT instance separately
    - Extracts unique collections from NFT list with owned count
  - Created client/src/composables/useNFTs.ts with:
    - Reactive access to NFT store data
    - fetchNFTs(), fetchAllowances(), fetchAll(), refresh() actions
    - setCollectionFilter() syncs with URL query param via vue-router
    - Watch for wallet address changes to auto-refetch
    - Watch for URL query param changes to sync filter
  - Created client/src/components/nfts/NFTCard.vue with:
    - NFT image or placeholder with gradient background
    - Collection name, NFT name, instance ID (truncated if long)
    - Status badges: Locked (yellow), In Use (blue), Burn authority (red)
    - Rarity badge if available
    - Transfer and Burn action buttons (Transfer disabled when locked/in-use)
  - Created client/src/components/nfts/NFTCardSkeleton.vue for loading state
  - Created client/src/components/nfts/NFTGrid.vue with:
    - Responsive grid (1/2/3/4 columns)
    - Loading skeleton state
    - Empty state when no NFTs
    - Emits transfer/burn events from child cards
  - Created client/src/components/nfts/CollectionFilter.vue with:
    - Dropdown with "All Collections" option
    - Lists collections with owned count
    - Checkmark on selected collection
    - Click outside to close
  - Created client/src/components/nfts/NFTSortDropdown.vue with:
    - Sort by collection A-Z/Z-A, instance ID low/high, name A-Z/Z-A
    - Checkmark on selected option
  - Updated client/src/views/NFTsView.vue with:
    - Collection filter and sort controls
    - NFT count display (total and filtered)
    - Clear filter button
    - Refresh button with loading animation
    - Error display with retry option
    - Wallet connection prompt when not connected
- Files changed:
  - client/src/stores/nfts.ts (new)
  - client/src/composables/useNFTs.ts (new)
  - client/src/components/nfts/NFTCard.vue (new)
  - client/src/components/nfts/NFTCardSkeleton.vue (new)
  - client/src/components/nfts/NFTGrid.vue (new)
  - client/src/components/nfts/CollectionFilter.vue (new)
  - client/src/components/nfts/NFTSortDropdown.vue (new)
  - client/src/views/NFTsView.vue (updated)
  - client/__tests__/stores/nfts.spec.ts (new - 33 tests)
  - client/__tests__/components/nfts/NFTCard.spec.ts (new - 16 tests)
  - client/__tests__/components/nfts/NFTGrid.spec.ts (new - 7 tests)
  - client/__tests__/components/nfts/CollectionFilter.spec.ts (new - 11 tests)
  - client/__tests__/components/nfts/NFTSortDropdown.spec.ts (new - 11 tests)
  - IMPLEMENTATION_PLAN.json (updated)
  - manualTestingRequired.txt (updated)
- GalaChain tools used: None (used existing useGalaChain composable)
- Tests: All 457 tests pass (431 client + 26 server)
- Learnings for future iterations:
  - TokenHold uses instanceId (singular) not instanceIds for the specific held instance
  - Use type casting with (h as { instanceId?: BigNumber }) when SDK types don't match actual runtime data
  - Collection filter syncs with URL via vue-router watch and push
  - NFT balances use instanceIds array - iterate to create individual NFT display objects
  - Filter out fungible tokens by checking if any instanceId is non-zero
---

## Iteration 16 - NFT Transfer Functionality
- What was implemented:
  - Created client/src/lib/schemas/transferNFTSchema.ts with:
    - Address validation using isValidGalaChainAddress (reused from transferSchema)
    - createTransferNFTSchema for recipient-only validation (no amount for NFTs)
    - truncateAddress and truncateInstanceId helper functions
  - Created client/src/composables/useTransferNFT.ts with:
    - buildTokenInstance() that uses specific NFT instance ID
    - executeTransfer() that sends quantity '1' (NFTs are always single)
    - Validation for locked/in-use NFTs before transfer attempt
    - Error handling for wallet not connected
  - Created client/src/components/nfts/TransferNFTModal.vue with:
    - NFT preview section (image/placeholder, name, collection, instance ID, rarity)
    - Recipient address input with validation
    - Two-step flow: form entry → confirmation
    - Warning about irreversible transfer
    - Loading state during transfer
    - Error display inline
  - Updated client/src/views/NFTsView.vue with:
    - Import and use of TransferNFTModal
    - Handler functions for transfer open/close/success
    - Automatic NFT list refresh after successful transfer
- Files changed:
  - client/src/lib/schemas/transferNFTSchema.ts (new)
  - client/src/composables/useTransferNFT.ts (new)
  - client/src/components/nfts/TransferNFTModal.vue (new)
  - client/src/views/NFTsView.vue (updated)
  - client/__tests__/lib/schemas/transferNFTSchema.spec.ts (new - 19 tests)
  - client/__tests__/composables/useTransferNFT.spec.ts (new - 10 tests)
  - client/__tests__/components/nfts/TransferNFTModal.spec.ts (new - 18 tests)
  - IMPLEMENTATION_PLAN.json (updated)
  - manualTestingRequired.txt (updated)
- GalaChain tools used: None (used existing useGalaChain composable and transferToken)
- Tests: All 504 tests pass (478 client + 26 server)
- Learnings for future iterations:
  - NFT transfers always use quantity '1' - different from fungible tokens
  - NFT transfer schema is simpler: only address validation (no amount)
  - Reuse isValidGalaChainAddress from transferSchema for consistency
  - Check canTransfer flag on NFTDisplay before allowing transfer
  - GalaChain address validation requires hex-only after prefix (a-f, 0-9)
---

## Iteration 17 - NFT Mint Functionality
- What was implemented:
  - Created client/src/composables/useNFTMintAuthority.ts for checking NFT mint allowances
    - nftMintAllowances - filters allowances for Mint type with instance 0 (collection-level)
    - authorizedCollections - returns collections user can mint from
    - hasAnyMintAuthority - whether user can mint any NFTs
    - getMintAllowance(), getMintAllowanceRemaining(), getMintAllowanceFormatted()
    - canMintFromCollection(), getCollectionMintAuthority()
    - isValidMintQuantity() - validates positive integer within allowance
  - Created client/src/composables/useMintNFT.ts for mint operations
    - executeMint() executes NFT mint via GalaChain mintToken
    - buildTokenClassKey() builds token class key from CollectionDisplay
    - Validates quantity is positive integer (NFTs can't be fractional)
    - Returns mintedInstances array on success
  - Created client/src/components/nfts/MintNFTModal.vue with:
    - Collection selector (disabled when only one collection)
    - Collection info display with image/placeholder
    - Mint allowance info (green theme)
    - Quantity input with increment/decrement/MAX buttons
    - MAX capped at 100 for UI performance
    - Two-step flow: form → confirmation
    - Shows recipient address (connected wallet)
    - Info notice about unique instance IDs
    - Loading state during mint
    - Error display inline
  - Updated client/src/views/NFTsView.vue with:
    - Mint NFT button in header (shown when hasAnyMintAuthority)
    - MintNFTModal component integration
    - Handlers for mint open/close/success
    - Auto-refresh NFT list after successful mint
- Files changed:
  - client/src/composables/useNFTMintAuthority.ts (new)
  - client/src/composables/useMintNFT.ts (new)
  - client/src/components/nfts/MintNFTModal.vue (new)
  - client/src/views/NFTsView.vue (updated)
  - client/__tests__/composables/useNFTMintAuthority.spec.ts (new - 28 tests)
  - client/__tests__/composables/useMintNFT.spec.ts (new - 16 tests)
  - client/__tests__/components/nfts/MintNFTModal.spec.ts (new - 13 tests)
  - IMPLEMENTATION_PLAN.json (updated)
  - manualTestingRequired.txt (updated)
- GalaChain tools used: Used /galachain:ask for NFT minting patterns
- Tests: All 535 tests pass (509 client + 26 server)
- Learnings for future iterations:
  - NFT mint allowances have instance 0 (or empty) - applies to collection level
  - NFT quantities must be positive integers (no fractional NFTs)
  - parseInt truncates decimals so '3.5' becomes 3 - may want explicit validation
  - Vue test mocking with ref/computed requires careful setup for reactivity
  - Use ref exported from module scope for mutable mock data in component tests
  - Collection selector disabled attribute test: check for presence not value
---

## Iteration 18 - NFT Burn Functionality
- What was implemented:
  - Created client/src/composables/useBurnNFT.ts for NFT burn operations
    - executeBurn() executes NFT burn via GalaChain burnTokens with quantity '1'
    - buildTokenInstance() builds token instance from NFTDisplay using specific instance ID
    - canBurnNFT() validates: has burn authority (canBurn), not locked, not in use
    - Reactive isBurning, isLoading, error states
  - Created client/src/components/nfts/BurnNFTModal.vue with:
    - NFT preview section (image/placeholder, name, collection, instance ID, rarity)
    - Prominent warning banner: "This NFT will be permanently destroyed"
    - Explanation that NFT cannot be recovered or recreated
    - Confirmation checkbox required before continuing
    - Two-step flow: form with checkbox → confirmation with final warning
    - Yellow warning if NFT cannot be burned (locked/in use)
    - Continue button disabled until checkbox checked AND canBurnNFT returns true
    - Red theme styling for burn UI (consistent with fungible token burn)
    - Loading state during burn execution
    - Error display inline
  - Updated client/src/views/NFTsView.vue with:
    - Import and use of BurnNFTModal (replaced placeholder code)
    - Handler functions for burn open/close/success
    - Automatic NFT list refresh after successful burn
  - Note: NFTCard already had burn button showing when canBurn is true (from nft-list task)
  - Note: Burn authority (canBurn flag) already computed in nfts store (from nft-list task)
- Files changed:
  - client/src/composables/useBurnNFT.ts (new)
  - client/src/components/nfts/BurnNFTModal.vue (new)
  - client/src/views/NFTsView.vue (updated - integrated BurnNFTModal)
  - client/__tests__/composables/useBurnNFT.spec.ts (new - 20 tests)
  - client/__tests__/components/nfts/BurnNFTModal.spec.ts (new - 18 tests)
  - IMPLEMENTATION_PLAN.json (updated)
  - manualTestingRequired.txt (updated)
- GalaChain tools used: None (used existing useGalaChain composable and burnTokens)
- Tests: All 599 tests pass (573 client + 26 server)
- Learnings for future iterations:
  - NFT burn always uses quantity '1' - different from fungible tokens
  - NFT burn validation should check canBurn flag, isLocked, and isInUse
  - Reuse patterns from BurnModal.vue (fungible tokens) for consistent UX
  - Store already computes canBurn from allowances - no need for separate authority composable
  - Two-step confirmation flow (form → confirm) is important for destructive actions
---

## Iteration 19 - Creators Page with Pump Interface
- What was implemented:
  - Created client/src/components/creators/PumpEntry.vue with:
    - Prominent gradient-bordered card with animated border effect
    - Pump icon and "Launch Tokens" badge
    - Description text explaining bonding curves, custom parameters, one-click deploy
    - Feature list with checkmarks
    - CTA button linking to pump.gala.games (external, opens in new tab)
    - Disabled state for when wallet not connected
    - Responsive design (stacks vertically on mobile)
  - Updated client/src/views/CreatorsView.vue with:
    - Pump Interface section at top (using PumpEntry component)
    - Visual divider with "NFT Collection Tools" label
    - NFT Collection Tools section with two cards:
      - Create Collection card with icon and description (button disabled, future task)
      - Manage Classes card with icon and description (button disabled, future task)
    - My Collections section with empty state placeholder
    - Wallet connection prompt (EmptyState) when not connected
  - Added comprehensive tests:
    - client/__tests__/components/creators/PumpEntry.spec.ts (24 tests)
    - client/__tests__/views/CreatorsView.spec.ts (18 tests)
- Files changed:
  - client/src/components/creators/PumpEntry.vue (new)
  - client/src/views/CreatorsView.vue (updated)
  - client/__tests__/components/creators/PumpEntry.spec.ts (new)
  - client/__tests__/views/CreatorsView.spec.ts (new)
  - IMPLEMENTATION_PLAN.json (updated)
- GalaChain tools used: None (UI/layout task)
- Tests: All 637 tests pass (611 client + 26 server)
- Learnings for future iterations:
  - Use ref() at module scope for mutable mock data that needs to change between tests
  - vi.mock must return the mock function directly; can't use vi.mocked().mockReturnValue() with refs
  - Gradient border effect: use outer container with gradient bg and inner container with solid bg
  - Animation on gradient: use background-size > 100% and animate background-position
---
## Iteration 20 - Creators Collections Management
- What was implemented:
  - Created client/src/stores/creatorCollections.ts Pinia store with:
    - State: collections[], isLoading, error, sortBy, lastFetched
    - Actions: setAllowances(), setBalances(), setLoading(), setError(), setSort(), toggleExpanded(), clearCollections(), getCollectionByKey(), needsRefresh()
    - Getters: sortedCollections (by name or minted count), hasCollections, totalCollectionCount
    - Collections identified by Mint allowance with instance 0 (collection-level authority)
    - CreatorCollectionDisplay extends CollectionDisplay with mintAllowanceRaw, mintAllowanceFormatted, hasUnlimitedMint, classes, isExpanded
    - CreatorClassDisplay type for future class management
    - UNLIMITED_THRESHOLD constant (1e50) for detecting unlimited mint
  - Created client/src/composables/useCreatorCollections.ts with:
    - Reactive access to collections store data
    - fetchCollections() queries allowances then enriches with balances
    - refresh(), setSort(), toggleExpanded(), getCollection() actions
    - clearCollections() for wallet disconnect cleanup
    - Watch for wallet connect/disconnect and address changes
  - Created client/src/components/creators/CollectionCard.vue with:
    - Collection image/placeholder with initials
    - Collection name, key (truncated if long), Authority badge
    - Owned count and mint allowance stats
    - Mint button (enabled), Manage Classes button (disabled for future task)
    - Expand/collapse button (disabled for future class list)
    - Expandable classes section (empty state placeholder)
  - Created client/src/components/creators/CollectionCardSkeleton.vue for loading state
  - Created client/src/components/creators/CollectionList.vue with:
    - Loading skeleton state (3 skeletons)
    - Empty state using EmptyState component
    - Collection cards with event forwarding (mint, manageClasses, toggleExpand)
  - Updated client/src/views/CreatorsView.vue with:
    - useCreatorCollections composable integration
    - My Collections section header with count badge
    - Refresh button with loading spinner
    - Error display with retry option
    - CollectionList component rendering collections
    - Handler functions for mint, manageClasses, toggleExpand events
    - fetchCollections on mount if connected
- Files changed:
  - client/src/stores/creatorCollections.ts (new)
  - client/src/composables/useCreatorCollections.ts (new)
  - client/src/components/creators/CollectionCard.vue (new)
  - client/src/components/creators/CollectionCardSkeleton.vue (new)
  - client/src/components/creators/CollectionList.vue (new)
  - client/src/views/CreatorsView.vue (updated)
  - client/__tests__/stores/creatorCollections.spec.ts (new - 26 tests)
  - client/__tests__/components/creators/CollectionCard.spec.ts (new - 17 tests)
  - client/__tests__/components/creators/CollectionList.spec.ts (new - 8 tests)
  - client/__tests__/views/CreatorsView.spec.ts (updated)
  - IMPLEMENTATION_PLAN.json (updated)
- GalaChain tools used: None (used existing useGalaChain composable for allowances/balances)
- Tests: All 669 tests pass (643 client + 26 server)
- Learnings for future iterations:
  - Collection authority identified by Mint allowance with instance 0 (collection-level, not instance-level)
  - Use AllowanceTypeEnum type import for type annotations but pass actual value at runtime
  - Component test for text containing 'Classes' must account for 'Manage Classes' button text
  - Testing multiple h3 elements: use findAll() and array method find() instead of first h3
  - Unused defineProps assignment causes vue-tsc error - just call defineProps without assignment
---

## Iteration 19 - creators-create-collection
- What was implemented:
  - Created client/src/lib/schemas/createCollectionSchema.ts with:
    - isValidIdentifier() - validates alphanumeric identifiers for collection keys
    - isValidImageUrl() - validates HTTP/HTTPS URLs
    - isValidMaxSupply() - validates positive integers or empty for unlimited
    - createCollectionSchema - Zod schema for complete collection form
    - getCreateCollectionTypedSchema() - VeeValidate typed schema wrapper
    - formatMaxSupply() - formats max supply for display (shows "Unlimited" for empty)
  - Created client/src/composables/useCreateCollection.ts with:
    - buildCreateInput() - converts form values to CreateTokenClassInput
    - executeCreate() - executes collection creation via createCollection
    - getCollectionKey() - generates collection key preview string
    - Reactive isCreating, error states
    - Integration with wallet store for connection status
  - Added createCollection function to client/src/lib/galachainClient.ts:
    - Uses TokenApi.CreateTokenClass from @gala-chain/connect
    - Accepts CreateTokenClassInput with all optional fields
    - Handles isNonFungible, decimals, maxSupply, maxCapacity, rarity, authorities
  - Created client/src/components/creators/CreateCollectionModal.vue with:
    - Native <dialog> element with Tailwind styling
    - VeeValidate + @vee-validate/zod form validation
    - Basic Information section (name, symbol, description, image URL)
    - Token Type section (NFT Collection / Fungible Token toggle)
    - Token Identifiers section (collection, category, type, additionalKey)
    - Collection key preview (updates as user types)
    - Advanced Options expandable (max supply, decimals for fungible)
    - Two-step flow: form → confirmation
    - Confirmation shows collection preview with all details
    - Info notice explaining what creating collection does
  - Updated client/src/views/CreatorsView.vue:
    - Enabled Create Collection button (was disabled placeholder)
    - Added CreateCollectionModal with open/close/success handlers
    - Refreshes collections list after successful creation
- Files changed:
  - client/src/lib/schemas/createCollectionSchema.ts (new)
  - client/src/composables/useCreateCollection.ts (new)
  - client/src/lib/galachainClient.ts (updated - added createCollection, TokenClass type)
  - client/src/components/creators/CreateCollectionModal.vue (new)
  - client/src/views/CreatorsView.vue (updated)
  - client/__tests__/lib/schemas/createCollectionSchema.spec.ts (new - 32 tests)
  - client/__tests__/composables/useCreateCollection.spec.ts (new - 15 tests)
  - client/__tests__/components/creators/CreateCollectionModal.spec.ts (new - 18 tests)
  - client/__tests__/views/CreatorsView.spec.ts (updated - button now enabled)
  - IMPLEMENTATION_PLAN.json (updated)
  - manualTestingRequired.txt (updated)
- GalaChain tools used: Checked TokenApi.CreateTokenClass signature from @gala-chain/connect
- Tests: All 748 tests pass (722 client + 26 server)
- Learnings for future iterations:
  - CreateTokenClass uses CreateTokenClassRequest type (not CreateTokenClassDto directly)
  - TokenClass type export from @gala-chain/connect for return type
  - Use spread with conditional to add optional DTO fields: ...(value && { key: value })
  - For SDK type compatibility, use `as Parameters<typeof api.Method>[0]` cast
  - isValidMaxSupply needs explicit string digit check (parseFloat('12abc') returns 12)
  - Vue test emits may not work reliably - test for button existence instead
  - Info text validation may fail if text is actually in attributes - test section headers instead
---

## Iteration 21 - creators-manage-classes
- What was implemented:
  - Created client/src/lib/schemas/createClassSchema.ts with:
    - isValidClassName() - validates class names (alphanumeric, spaces, hyphens, underscores)
    - isValidClassIdentifier() - validates additionalKey (alphanumeric only, no spaces)
    - isValidMaxSupply() - validates positive integers or empty for unlimited
    - isValidImageUrl() - validates HTTP/HTTPS URLs
    - createClassSchema - Zod schema for class creation form
    - getCreateClassTypedSchema() - VeeValidate typed schema wrapper
    - formatMaxSupply() - formats max supply for display
    - generateClassKey() - generates class key from collection + additionalKey
  - Created client/src/composables/useManageClasses.ts with:
    - buildCreateInput() - converts CreateClassInput to CreateTokenClassInput
    - createClass() - executes class creation via createCollection API
    - getClassKeyPreview() - generates class key preview string
    - isAdditionalKeyAvailable() - checks if additionalKey is unique within collection
    - Reactive isCreating, error states
    - Integration with wallet store for connection status
  - Created client/src/components/creators/ClassCard.vue with:
    - Class icon with initials from name
    - Class name and additionalKey (truncated if long)
    - Progress bar showing minted vs max supply
    - Supply display (minted / max or ∞ for unlimited)
    - Mint button when canMintMore is true, "Max Reached" label otherwise
  - Created client/src/components/creators/ClassList.vue with:
    - Loading skeleton state
    - Empty state with "Create your first class" prompt
    - ClassCard rendering with mint event forwarding
    - createClass event for empty state CTA
  - Created client/src/components/creators/CreateClassModal.vue with:
    - Native <dialog> element with Tailwind styling
    - VeeValidate + @vee-validate/zod form validation
    - Form fields: name, additionalKey (class identifier), description, image, maxSupply, rarity
    - Class key preview (updates as user types additionalKey)
    - Two-step flow: form → confirmation
    - Confirmation shows class preview with all details
    - Info notice explaining what creating class does
    - Loading state during creation
  - Updated client/src/components/creators/CollectionCard.vue:
    - Enabled "Manage Classes" button (was disabled placeholder)
    - Enabled expand/collapse button (was disabled)
    - Button emits manageClasses event when clicked
  - Updated client/src/views/CreatorsView.vue:
    - Added CreateClassModal import and state
    - Added selectedCollectionForClass ref for modal
    - Updated handleManageClasses to open CreateClassModal with selected collection
    - Added closeCreateClassModal and handleClassCreated handlers
    - Changed "Manage Classes" card to show guidance text instead of disabled button
    - Refreshes collections list after successful class creation
- Files changed:
  - client/src/lib/schemas/createClassSchema.ts (new)
  - client/src/composables/useManageClasses.ts (new)
  - client/src/components/creators/ClassCard.vue (new)
  - client/src/components/creators/ClassList.vue (new)
  - client/src/components/creators/CreateClassModal.vue (new)
  - client/src/components/creators/CollectionCard.vue (updated - enabled buttons)
  - client/src/views/CreatorsView.vue (updated - integrated CreateClassModal)
  - client/__tests__/lib/schemas/createClassSchema.spec.ts (new - 20 tests)
  - client/__tests__/composables/useManageClasses.spec.ts (new - 12 tests)
  - client/__tests__/components/creators/ClassCard.spec.ts (new - 10 tests)
  - client/__tests__/components/creators/ClassList.spec.ts (new - 5 tests)
  - client/__tests__/components/creators/CreateClassModal.spec.ts (new - 11 tests)
  - client/__tests__/components/creators/CollectionCard.spec.ts (updated - button enabled tests)
  - client/__tests__/views/CreatorsView.spec.ts (updated - guidance text test)
  - IMPLEMENTATION_PLAN.json (updated)
- GalaChain tools used: Used /galachain:ask for CreateTokenClass patterns
- Tests: All 833 tests pass (807 client + 26 server)
- Learnings for future iterations:
  - Token classes are created using the same CreateTokenClass API as collections
  - The additionalKey field distinguishes classes within a collection
  - Class identifier (additionalKey) should be alphanumeric without spaces for clean key generation
  - Existing createCollection function in galachainClient.ts works for creating classes too
  - VeeValidate form step transitions in tests are async - need flushPromises() between steps
  - When changing button from disabled to enabled, update both the component and its tests
---


## Iteration 22 - creators-mint-from-collection
- What was implemented:
  - Created client/src/composables/useCollectionMint.ts with:
    - executeMintFromCollection() for minting at collection level
    - executeMintFromClass() for minting from a specific class
    - buildTokenClassKeyFromCollection() and buildTokenClassKeyFromClass() helpers
    - getMaxMintableQuantity() and getMaxMintableQuantityForClass() for UI caps
    - validateMintQuantity() for form validation against allowance and supply
    - Reactive isMinting, isLoading, error, isConnected, ownerAddress states
  - Created client/src/components/creators/CollectionMintModal.vue with:
    - Native <dialog> element with Tailwind styling
    - Collection info display with image/placeholder and mint allowance
    - Class selector when collection has classes (optional)
    - Class supply info display when class selected
    - Quantity input with increment/decrement/MAX buttons
    - Two-step flow: form → confirmation
    - Confirmation shows collection/class, quantity, recipient
    - Info notice about wallet signing and unique instance IDs
    - Green theme styling (consistent with other mint modals)
    - Loading state during mint execution
  - Updated client/src/views/CreatorsView.vue with:
    - Import and state for CollectionMintModal
    - handleMint() now opens CollectionMintModal (was placeholder)
    - closeMintModal() and handleMintSuccess() handlers
    - Auto-refresh collections after successful mint
- Files changed:
  - client/src/composables/useCollectionMint.ts (new)
  - client/src/components/creators/CollectionMintModal.vue (new)
  - client/src/views/CreatorsView.vue (updated)
  - client/__tests__/composables/useCollectionMint.spec.ts (new - 25 tests)
  - client/__tests__/components/creators/CollectionMintModal.spec.ts (new - 21 tests)
  - IMPLEMENTATION_PLAN.json (updated)
  - manualTestingRequired.txt (updated)
- GalaChain tools used: None (reused existing useGalaChain.mintToken)
- Tests: All 879 tests pass (853 client + 26 server)
- Learnings for future iterations:
  - Collection-level mint uses collection's additionalKey, class-level uses class's additionalKey
  - Validation must check both mint allowance AND remaining class supply
  - HTMLDialogElement.showModal() requires mocking in jsdom tests (beforeAll HTMLDialogElement.prototype.showModal = vi.fn())
  - Reuse patterns from MintNFTModal.vue for consistent UX across mint modals
  - Supply validation should prioritize allowance check before supply check (allowance is more restrictive usually)
  - Class canMintMore flag already computed in store - check it before attempting mint
---

## Iteration 23 - toast-notifications
- What was implemented:
  - Created client/src/stores/toasts.ts Pinia store with:
    - State: toasts[] with id, type, message, title, duration, dismissible, createdAt
    - Actions: addToast(), removeToast(), clearAll(), getToastById(), updateToast()
    - Convenience methods: success(), error(), pending(), info() with appropriate defaults
    - Getters: activeToasts, hasToasts, toastCount
    - Default durations: success/info = 5000ms (auto-dismiss), error/pending = 0 (no auto-dismiss)
    - generateId() creates unique toast IDs
  - Created client/src/components/ui/Toast.vue with:
    - Type-based styling: success (green), error (red), pending (blue), info (gray)
    - Icon per type (checkmark, x, spinner, info)
    - Auto-dismiss timer using setTimeout (duration > 0)
    - Dismiss button when dismissible is true
    - Accessibility: role="alert", aria-live="assertive", aria-atomic="true"
    - Title + message content with optional title
  - Created client/src/components/ui/ToastContainer.vue with:
    - Teleport to body for proper layering
    - Fixed bottom-right positioning (bottom-4 right-4 z-50)
    - TransitionGroup with slide-in/out animations from right
    - Vertical stacking with gap
  - Created client/src/composables/useToast.ts with:
    - Convenience methods: success(), error(), pending(), info()
    - add() for custom toasts with full options
    - remove(), update(), clearAll() for management
    - resolveSuccess(), resolveError() for updating pending toasts
    - transaction() helper for transaction workflows (returns object with success/error/dismiss)
  - Integrated ToastContainer into Layout.vue for global availability
- Files changed:
  - client/src/stores/toasts.ts (new)
  - client/src/components/ui/Toast.vue (new)
  - client/src/components/ui/ToastContainer.vue (new)
  - client/src/composables/useToast.ts (new)
  - client/src/views/Layout.vue (updated - added ToastContainer)
  - client/__tests__/stores/toasts.spec.ts (new - 38 tests)
  - client/__tests__/components/ui/Toast.spec.ts (new - 24 tests)
  - client/__tests__/components/ui/ToastContainer.spec.ts (new - 8 tests)
  - client/__tests__/composables/useToast.spec.ts (new - 23 tests)
  - IMPLEMENTATION_PLAN.json (updated)
- GalaChain tools used: None (UI/state management task)
- Tests: All 972 tests pass (946 client + 26 server)
- Learnings for future iterations:
  - Vue Teleport to body works well for overlay components like toasts
  - TransitionGroup with named transitions (toast-enter-from, toast-leave-to) for smooth animations
  - Use vi.useFakeTimers() and vi.advanceTimersByTime() to test auto-dismiss behavior
  - Toast updateToast() is useful for changing pending toasts to success/error
  - transaction() helper pattern: returns object with success()/error()/dismiss() methods
  - Default non-dismissible for pending toasts prevents accidental dismissal during operations
---

## Iteration 24 - transaction-status
- What was implemented:
  - Created client/src/stores/transactions.ts Pinia store with:
    - State: pendingTxs[], recentTxs[] (with MAX_RECENT_TRANSACTIONS = 10)
    - Actions: addPending(), updateStatus(), markComplete(), markFailed(), getPendingById(), getRecentById(), clearRecent(), clearPending(), clearAll()
    - Getters: hasPendingTxs, pendingCount, hasRecentTxs, recentCount
    - Integration with toasts store for automatic toast management
    - Helper functions: getExplorerUrl(), getTransactionTypeLabel(), getTransactionStatusLabel()
  - Created client/src/components/ui/TransactionIndicator.vue with:
    - Transaction icon button with pending count badge (animated pulse)
    - Dropdown showing pending and recent transactions
    - Pending section with spinner animation and status
    - Recent section with confirmed/failed status icons
    - Explorer link for confirmed transactions with hash
    - Time formatting (Just now, Xm ago, Xh ago)
    - Clear recent transactions button
    - Empty state when no transactions
  - Integrated TransactionIndicator into Layout.vue header (between navigation and WalletConnect)
- Files changed:
  - client/src/stores/transactions.ts (new)
  - client/src/components/ui/TransactionIndicator.vue (new)
  - client/src/views/Layout.vue (updated - added TransactionIndicator)
  - client/__tests__/stores/transactions.spec.ts (new - 50 tests)
  - client/__tests__/components/ui/TransactionIndicator.spec.ts (new - 29 tests)
  - IMPLEMENTATION_PLAN.json (updated)
- GalaChain tools used: None (used existing toast system and shared types)
- Tests: All 1051 tests pass (1025 client + 26 server)
- Learnings for future iterations:
  - Transaction store integrates with toasts store for unified notification experience
  - Use storeToRefs for reactive access to store state in components
  - TransactionStatus and TransactionType enums already defined in shared/types/display.ts
  - Recent transactions list capped at 10 with oldest removed first
  - markComplete/markFailed both move transaction from pending to recent array
  - Explorer URL pattern: https://explorer.galachain.com/tx/{hash}
---

## Iteration 25 - error-handling
- What was implemented:
  - Created shared/errors.ts with typed error classes:
    - AppError base class with code, severity, recoverable, action, details, originalError, timestamp
    - GalaChainError for chain-specific errors with errorKey and errorPayload
    - WalletError for wallet connection/signing errors
    - NetworkError for network/API errors with statusCode
    - ValidationError for input validation errors with field
    - ErrorCode enum (1xxx: GalaChain, 2xxx: Wallet, 3xxx: Network, 4xxx: Validation, 9xxx: Unknown)
    - ErrorSeverity enum (Info, Warning, Error, Critical)
    - Type guards: isAppError, isGalaChainError, isWalletError, isNetworkError, isValidationError
    - Helpers: getErrorMessage, getErrorAction, wrapError
  - Created client/src/lib/errorHandler.ts with:
    - WALLET_ERROR_PATTERNS for parsing wallet errors (user rejected, locked, not installed, etc.)
    - NETWORK_ERROR_PATTERNS for parsing network errors (connection, timeout, server error)
    - GALACHAIN_ERROR_MAP for mapping GalaChain error keys to user-friendly messages
    - parseWalletError(), parseNetworkError(), parseGalaChainError(), parseError() functions
    - logError() for development console logging with grouped output
    - getErrorDisplayInfo() for UI-ready error information
  - Created client/src/components/ui/ErrorDisplay.vue with:
    - Severity-based styling (Info: blue, Warning: yellow, Error: red, Critical: red with border-2)
    - Compact mode option for smaller padding/text
    - Icons for each severity level
    - Optional action text or action button
    - Optional error code display (dev mode)
    - Dismissible option with dismiss button
    - Accessibility: role="alert", aria-live="assertive"
  - Added Vue global error handler in client/src/main.ts:
    - app.config.errorHandler parses errors and logs in dev mode
    - Shows toast for critical errors via dynamic import
    - app.config.warnHandler logs warnings with component trace in dev mode
  - Updated Jest config to include shared folder tests
- Files changed:
  - shared/errors.ts (new)
  - shared/index.ts (updated - exports errors)
  - client/src/lib/errorHandler.ts (new)
  - client/src/components/ui/ErrorDisplay.vue (new)
  - client/src/main.ts (updated - added error/warn handlers)
  - jest.config.js (updated - includes shared tests)
  - shared/__tests__/errors.spec.ts (new - 33 tests)
  - client/__tests__/lib/errorHandler.spec.ts (new - 42 tests)
  - client/__tests__/components/ui/ErrorDisplay.spec.ts (new - 27 tests)
  - IMPLEMENTATION_PLAN.json (updated)
  - manualTestingRequired.txt (updated)
- GalaChain tools used: None (error handling infrastructure)
- Tests: All 1154 tests pass (1094 client + 60 server)
- Learnings for future iterations:
  - Use regex patterns array for error matching to support multiple patterns per error type
  - Order patterns from most specific to most general for correct matching
  - ErrorSeverity.Warning for validation, ErrorSeverity.Error for most failures
  - All errors have recoverable flag and optional action suggestion
  - Dynamic import for toast store in error handler avoids circular dependencies
  - Use _instance prefix for unused parameters to satisfy TypeScript
  - getErrorMessage() returns empty string for empty string input, enabling || fallback
---

## Iteration 26 - responsive-design
- What was implemented:
  - Created client/src/components/ui/MobileMenu.vue slide-out drawer:
    - Teleport to body for proper z-index layering
    - Slide-in/out transitions from right edge
    - Backdrop click to close
    - ESC key to close
    - Body scroll lock when open (document.body.style.overflow = 'hidden')
    - Auto-close on route change
    - Navigation items with icons and descriptions
    - "Coming Soon" badge on Export item
    - Touch-target sizes (44px minimum)
    - Safe-area padding for notched devices
  - Updated client/src/views/Layout.vue:
    - Integrated MobileMenu component with open/close state
    - Updated hamburger button with minimum touch target size (44px)
    - Added safe-area-layout class for left/right safe area padding
  - Updated client/src/style.css with responsive utilities:
    - body overflow-x: hidden to prevent horizontal scroll
    - Safe area padding for notched devices (env() values)
    - Minimum touch target sizes on interactive elements (44px)
    - Input font-size: 16px to prevent iOS zoom on focus
    - .touch-target utility class
    - .modal-responsive utility class
    - .scrollbar-hide utility class
    - Safe area utility classes (.safe-area-top, .safe-area-bottom, etc.)
  - Updated all modals to be full-screen on mobile:
    - TransferModal.vue, MintModal.vue, BurnModal.vue (fungible tokens)
    - TransferNFTModal.vue, MintNFTModal.vue, BurnNFTModal.vue (NFTs)
    - CreateCollectionModal.vue, CollectionMintModal.vue (creators)
    - CreateClassModal.vue (already had good scoped modal styles, updated to be responsive)
    - Pattern: inset-0 m-0 w-full h-full max-w-none max-h-none rounded-none on mobile
    - Pattern: sm:inset-auto sm:m-auto sm:w-full sm:max-w-md sm:h-auto sm:max-h-[90vh] sm:rounded-xl on desktop
- Files changed:
  - client/src/components/ui/MobileMenu.vue (new)
  - client/src/views/Layout.vue (updated)
  - client/src/style.css (updated)
  - client/src/components/tokens/TransferModal.vue (updated)
  - client/src/components/tokens/MintModal.vue (updated)
  - client/src/components/tokens/BurnModal.vue (updated)
  - client/src/components/nfts/TransferNFTModal.vue (updated)
  - client/src/components/nfts/MintNFTModal.vue (updated)
  - client/src/components/nfts/BurnNFTModal.vue (updated)
  - client/src/components/creators/CreateCollectionModal.vue (updated)
  - client/src/components/creators/CollectionMintModal.vue (updated)
  - client/src/components/creators/CreateClassModal.vue (updated)
  - client/__tests__/components/ui/MobileMenu.spec.ts (new - 23 tests)
  - IMPLEMENTATION_PLAN.json (updated)
  - manualTestingRequired.txt (updated)
- GalaChain tools used: None (UI/responsive design task)
- Tests: All 1177 tests pass (1117 client + 60 server)
- Learnings for future iterations:
  - Vue watcher on props doesn't trigger on initial mount if prop is already set - test with prop transitions
  - Tailwind sm: breakpoint is 640px - use for modal responsive switching point
  - Body scroll lock: set document.body.style.overflow = 'hidden' in watcher, clear in watcher and onUnmounted
  - Safe area insets: use env(safe-area-inset-*) CSS functions
  - Touch targets: 44px minimum per Apple HIG
  - Input font-size 16px prevents iOS Safari zoom on focus
  - Teleport to body ensures proper z-index stacking for overlays
---

## Iteration 27 - testing
- What was implemented:
  - Created client/__tests__/fixtures/ directory with comprehensive mock data:
    - tokens.ts: Mock TokenBalance objects, FungibleTokenDisplay objects, factory functions
    - nfts.ts: Mock NFT balances, NFTDisplay objects, CollectionDisplay objects, factory functions
    - collections.ts: CreatorCollectionDisplay and CreatorClassDisplay interfaces and mocks
    - allowances.ts: Mock TokenAllowance objects, AllowanceDisplay objects, factory functions
    - index.ts: Barrel export with common test constants (addresses, user aliases)
  - Created client/__tests__/mocks/ directory with module mocks:
    - galachain-connect.ts: MockBrowserConnectClient, MockTokenApi, factory functions
    - galachain-client.ts: Mock implementations for all client functions with setters
    - wallet-store.ts: Mock wallet state with setters (connected/disconnected/error)
    - use-galachain.ts: Mock composable with configurable operation results
    - index.ts: Barrel export with utility functions (mockDialogElement, mockMatchMedia, etc.)
  - Configured Storybook for Vue 3 with Vite:
    - Updated .storybook/main.ts with path aliases (@, @shared)
    - Updated .storybook/preview.ts with Pinia, Tailwind CSS, dark background
    - Created stories for UI components: LoadingSpinner, EmptyState, Toast, ErrorDisplay
    - Created TokenCard.stories.ts for token component documentation
  - Configured Playwright for E2E tests:
    - Created playwright.config.ts with Chromium project, dev server config
    - Created e2e/navigation.spec.ts for navigation tests
    - Created e2e/wallet-mock.spec.ts with mock wallet injection pattern
    - Added test:e2e and test:e2e:ui scripts to client/package.json
- Files changed:
  - client/__tests__/fixtures/tokens.ts (new)
  - client/__tests__/fixtures/nfts.ts (new)
  - client/__tests__/fixtures/collections.ts (new)
  - client/__tests__/fixtures/allowances.ts (new)
  - client/__tests__/fixtures/index.ts (new)
  - client/__tests__/mocks/galachain-connect.ts (new)
  - client/__tests__/mocks/galachain-client.ts (new)
  - client/__tests__/mocks/wallet-store.ts (new)
  - client/__tests__/mocks/use-galachain.ts (new)
  - client/__tests__/mocks/index.ts (new)
  - client/.storybook/main.ts (updated)
  - client/.storybook/preview.ts (updated)
  - client/src/components/ui/LoadingSpinner.stories.ts (new)
  - client/src/components/ui/EmptyState.stories.ts (new)
  - client/src/components/ui/Toast.stories.ts (new)
  - client/src/components/ui/ErrorDisplay.stories.ts (new)
  - client/src/components/tokens/TokenCard.stories.ts (new)
  - client/playwright.config.ts (new)
  - client/e2e/navigation.spec.ts (new)
  - client/e2e/wallet-mock.spec.ts (new)
  - client/package.json (updated - added test:e2e scripts)
  - IMPLEMENTATION_PLAN.json (updated - testing task passed)
- GalaChain tools used: None (testing infrastructure)
- Tests: All 1177 tests pass (1117 client + 60 server)
- Learnings for future iterations:
  - Storybook 10.x uses @storybook/vue3-vite for Vue 3 projects
  - viteFinal config in Storybook allows path alias configuration
  - Centralized test fixtures prevent duplication across test files
  - Module mocks with factory functions allow test-specific configuration
  - Playwright window.__MOCK_WALLET__ pattern allows E2E testing without real wallet
  - Stories require correct prop types - check component defineProps for actual property names
---

## Iteration 28 - export-placeholder
- What was implemented:
  - Created client/src/components/export/ExportComingSoon.vue with:
    - Hero section with Coming Soon badge and description
    - Export preview mockup with muted/disabled styling (opacity-75)
      - Date range filter mockup (Start Date / End Date inputs)
      - Token type filter mockup (Fungible Tokens / NFTs / All Transactions checkboxes)
      - Transaction types filter mockup (Transfers / Mints / Burns / Allowances pills)
      - Disabled "Export to CSV" button
    - Planned Features list with icons and descriptions:
      - Date Range Filters
      - FT/NFT Selection
      - CSV Download
      - Transaction History
    - Email notification signup form:
      - Email input with validation
      - Notify Me button with loading state
      - Success message after submission
      - Simulated submission (would connect to backend in production)
    - Gray/muted color theme throughout to indicate coming soon status
  - Updated client/src/views/ExportView.vue to use ExportComingSoon component
  - Created client/src/components/export/ExportComingSoon.stories.ts with:
    - Default story
    - Mobile viewport story
    - Tablet viewport story
  - Created client/__tests__/components/export/ExportComingSoon.spec.ts with 24 tests covering:
    - Rendering (7 tests): Coming Soon badge, heading, description, mockup sections
    - Planned Features (5 tests): All 4 features listed
    - Email Notification Signup (8 tests): Form rendering, validation, submission
    - Styling (4 tests): Gray theme, disabled cursor, opacity
- Files changed:
  - client/src/components/export/ExportComingSoon.vue (new)
  - client/src/components/export/ExportComingSoon.stories.ts (new)
  - client/__tests__/components/export/ExportComingSoon.spec.ts (new)
  - client/src/views/ExportView.vue (updated - uses ExportComingSoon component)
  - IMPLEMENTATION_PLAN.json (updated - marked export-placeholder as passed)
- GalaChain tools used: None (UI placeholder task)
- Tests: All 1201 tests pass (1141 client + 60 server)
- Learnings for future iterations:
  - Coming soon pages benefit from visual mockups showing planned functionality
  - Gray/muted styling clearly indicates disabled/upcoming features
  - Email signup for notifications is a good engagement pattern for upcoming features
  - Simulate form submissions in tests with vi.useFakeTimers() and vi.advanceTimersByTimeAsync()
  - opacity-75 on container elements effectively mutes child content
---

## Iteration 29 - Fix GalaChain URL Configuration
- What was implemented:
  - Corrected GALACHAIN_GATEWAY_URL to use the proper endpoints:
    - Production: https://gateway-mainnet.galachain.com/api/asset/token-contract
    - Stage: https://gateway-testnet.galachain.com/api/testnet01/gc-a9b8b472b035c0510508c248d1110d3162b7e5f4-GalaChainToken
  - Removed separate GALACHAIN_API_URL since all chaincode invocations go through the gateway
  - Updated server configuration (src/config/configuration.ts) to only use gatewayUrl
  - Updated client configuration (client/src/lib/config.ts) to only use gatewayUrl
  - Updated galachainClient.ts getTokenApiUrl() to return gatewayUrl directly (it's now the complete URL)
  - Updated all related tests to reflect the new URL structure
- Files changed:
  - .env (updated - not tracked in git)
  - .env.example (updated)
  - client/.env (updated - not tracked in git)
  - src/config/configuration.ts (removed apiUrl)
  - src/__tests__/configuration.spec.ts (updated tests)
  - client/src/lib/config.ts (removed apiUrl)
  - client/__tests__/config.spec.ts (updated tests)
  - client/src/lib/galachainClient.ts (use gatewayUrl directly)
  - client/__tests__/lib/galachainClient.spec.ts (updated tests)
  - client/__tests__/mocks/galachain-client.ts (updated mock)
- GalaChain tools used: None (configuration fix)
- Tests: All 1197 tests pass (1139 client + 58 server)
- Learnings for future iterations:
  - GalaChain gateway URL is the complete endpoint URL, not a base URL
  - There is no separate API URL - all chaincode invocations go through the gateway
  - Production uses gateway-mainnet.galachain.com, stage uses gateway-testnet.galachain.com
  - The testnet URL includes the specific contract path for the GalaChainToken contract
---

## Iteration 30 - Fix Read Operations (No Signing Required)
- What was implemented:
  - Read operations (FetchBalances, FetchAllowances) no longer require wallet signing
  - Created unsignedPost() function that makes direct HTTP POST requests to the gateway
  - fetchBalances() and fetchAllowances() now use unsignedPost() instead of TokenApi
  - Changed function signatures: removed BrowserConnectClient parameter from read operations
  - getBalances/getAllowances in useGalaChain composable now require owner address but NOT wallet connection
  - Write operations (transfer, mint, burn, createCollection) still use TokenApi with signing
- Files changed:
  - client/src/lib/galachainClient.ts:
    - Added GalaChainResponse<T> interface for HTTP response structure
    - Added unsignedPost() for unsigned HTTP POST requests
    - fetchBalances() now takes (owner, filters?) instead of (client, owner, filters?)
    - fetchAllowances() now takes (grantedTo, filters?) instead of (client, grantedTo, filters?)
    - Renamed executeApiCall to executeSignedApiCall for clarity
  - client/src/composables/useGalaChain.ts:
    - getBalances(owner, filters?) - requires address, NOT wallet connection
    - getAllowances(grantedTo, filters?) - requires address, NOT wallet connection
    - Write operations unchanged (still require wallet connection)
  - client/src/composables/useFungibleTokens.ts - pass walletStore.address to getBalances/getAllowances
  - client/src/composables/useNFTs.ts - pass walletStore.address to getBalances/getAllowances
  - client/src/composables/useCreatorCollections.ts - pass walletStore.address to getBalances/getAllowances
  - client/__tests__/lib/galachainClient.spec.ts - mock fetch instead of TokenApi for read operations
  - client/__tests__/composables/useGalaChain.spec.ts - test read operations without wallet connection
  - client/__tests__/mocks/galachain-client.ts - update mock signatures
- GalaChain tools used: None (SDK pattern fix)
- Tests: All 1204 tests pass (1146 client + 58 server)
- Learnings for future iterations:
  - GalaChain read operations do NOT require signing - use direct HTTP POST
  - GalaChain write operations DO require signing - use TokenApi with BrowserConnectClient
  - Successful responses have Status: 1, errors have Status: 0
  - When fetching data for display, you can call the API without wallet connection
  - Only prompt for wallet/signing when the user takes an action (transfer, mint, burn)
---

## Iteration 31 - transfer-balance-decimals (Issue Fix)
- What was implemented:
  - Fixed incorrect decimal handling where balances were being divided by 10^8
  - GalaChain quantity values are already the actual token amounts - no decimal conversion needed
  - Removed the division by 10^decimals from all formatting functions
- Files changed:
  - client/src/stores/tokens.ts:
    - Updated formatBalance() to NOT divide by 10^decimals
    - Added comment explaining GalaChain quantities are actual amounts
  - client/src/lib/schemas/mintSchema.ts:
    - Updated formatMintAmount() to NOT divide by 10^decimals
    - Renamed decimals param to _decimals (unused, kept for API compatibility)
  - client/src/lib/schemas/burnSchema.ts:
    - Updated formatBurnAmount() to NOT divide by 10^decimals
    - Renamed decimals param to _decimals (unused, kept for API compatibility)
  - client/__tests__/lib/schemas/mintSchema.spec.ts - updated tests for new behavior
  - client/__tests__/lib/schemas/burnSchema.spec.ts - updated tests for new behavior
- GalaChain tools used: None
- Tests: All 1204 tests pass (1146 client + 58 server)
- Learnings for future iterations:
  - GalaChain quantity values from the API are the ACTUAL token amounts
  - No decimal conversion/division is needed when displaying balances
  - The previous code incorrectly assumed values were in smallest units (like Wei for ETH)
  - This pattern differs from Ethereum where values are in Wei and need division by 10^18
---

## Iteration 33 - balances-with-metadata (Issue Fix)
- What was implemented:
  - Added FetchBalancesWithTokenMetadata endpoint integration
  - Created fetchBalancesWithMetadata function in galachainClient.ts
  - Returns TokenBalanceWithMetadata[] containing both balance and token class metadata
  - Updated tokens store with setBalancesWithMetadata() that extracts metadata
  - Updated nfts store with setBalancesWithMetadata() that extracts metadata
  - Updated useFungibleTokens.ts to use getBalancesWithMetadata
  - Updated useNFTs.ts to use getBalancesWithMetadata
  - Added useGalaChain.getBalancesWithMetadata() for the composable layer
  - Token/NFT display objects now receive proper name, symbol, description, image, decimals, rarity from metadata
  - Used TokenBalanceAny union type and TokenBalanceData interface to handle type differences between @gala-chain/connect and @gala-chain/api TokenBalance versions
- Files changed:
  - client/src/lib/galachainClient.ts (added fetchBalancesWithMetadata, exports TokenBalanceWithMetadata)
  - client/src/composables/useGalaChain.ts (added getBalancesWithMetadata)
  - client/src/composables/useFungibleTokens.ts (uses getBalancesWithMetadata)
  - client/src/composables/useNFTs.ts (uses getBalancesWithMetadata)
  - client/src/stores/tokens.ts (added setBalancesWithMetadata, TokenBalanceAny union type)
  - client/src/stores/nfts.ts (added setBalancesWithMetadata, TokenBalanceAny union type)
  - ISSUES_FIX_PLAN.json (marked balances-with-metadata as passed)
  - manualTestingRequired.txt (added balances-with-metadata testing checklist)
- GalaChain tools used: /galachain:ask for FetchBalancesWithMetadata endpoint (not found in topics, used SDK inspection)
- Tests: All automated tests pass (1142/1143 - 1 pre-existing failure in CreateCollectionModal unrelated to changes)
- Learnings for future iterations:
  - FetchBalancesWithTokenMetadata endpoint returns { results: TokenBalanceWithMetadata[] }
  - TokenBalanceWithMetadata has .balance (TokenBalance) and .token (TokenClass) properties
  - TokenClass contains: name, symbol, description, image, decimals, rarity, etc.
  - @gala-chain/api TokenBalance has some private properties that @gala-chain/connect version doesn't
  - Use union type and interface casting to handle property access across both versions
  - The existing setBalances() functions still work for backward compatibility
---

## Iteration 32 - nft-collection-flow (Issue Fix)
- What was implemented:
  - Implemented new 3-step NFT collection creation flow: Claim -> Create -> Confirm
  - Added new GalaChain API endpoints to galachainClient.ts:
    - grantNftCollectionAuthorization() - Claims a collection name (Step 1)
    - createNftCollection() - Creates collection from claimed name (Step 2)
    - fetchNftCollectionAuthorizations() - Fetches user's claimed collections (unsigned read)
  - Created client/src/composables/useNftCollectionAuth.ts with:
    - claimCollectionName() - Grants authorization to create a collection
    - createCollection() - Creates NFT collection from claimed authorization
    - fetchAuthorizations() - Fetches all claimed collections
    - useCollectionCreationFlow() - Helper for managing the claim-then-create flow
    - Reactive state: isLoading, isClaiming, isCreating, error, claimedCollections
  - Completely rewrote client/src/components/creators/CreateCollectionModal.vue:
    - Step 1: Claim collection name with info about two-step process
    - Step 2: Fill in collection details (name, symbol, description, image, category, type, additionalKey)
    - Step 3: Confirmation with preview and create button
    - Step indicator showing progress through all 3 steps
    - Shows previously claimed collections that can be used
    - REMOVED FT creation option (modal is now NFT-only)
    - Uses new useNftCollectionAuth composable
  - Updated client/src/stores/creatorCollections.ts:
    - Added claimedCollections state
    - Added CollectionStatus type ('claimed' | 'created')
    - Added setClaimedCollections(), addClaimedCollection(), markCollectionCreated() actions
    - Added hasClaimedCollections and pendingClaimedCollections getters
  - Updated tests in client/__tests__/components/creators/CreateCollectionModal.spec.ts:
    - Rewrote all tests to match new 3-step flow
    - Tests for Step 1 claim form
    - Tests for NFT-only mode (no FT toggle)
    - Tests for modal behavior and form validation
- Files changed:
  - client/src/lib/galachainClient.ts (added NFT collection endpoints)
  - client/src/composables/useNftCollectionAuth.ts (new)
  - client/src/components/creators/CreateCollectionModal.vue (completely rewritten)
  - client/src/stores/creatorCollections.ts (added claimed collections tracking)
  - client/__tests__/components/creators/CreateCollectionModal.spec.ts (rewritten)
  - ISSUES_FIX_PLAN.json (marked nft-collection-flow as passed)
  - ISSUES_FIX_PLAN.json (marked hide-ft-creation as passed)
  - manualTestingRequired.txt (added nft-collection-flow testing checklist)
- GalaChain tools used: /galachain:ask for NFT collection creation flow research
- Tests: All 1201 tests pass (1143 client + 58 server)
- Learnings for future iterations:
  - NFT collection creation uses a 2-transaction flow: GrantNftCollectionAuthorization then CreateNftCollection
  - FetchNftCollectionAuthorizationsWithPagination is an unsigned read operation
  - The collection name in CreateNftCollectionDto must match an existing authorization
  - TokenApi doesn't have built-in methods for these endpoints - use type casting with unknown
  - VeeValidate error messages only show after interaction - test with setValue() not just initial render
  - The new flow explicitly separates claiming a name from creating the collection
---

## Iteration 34 - token-identification (Issue Fix)
- What was implemented:
  - Created getTokenIdentifier utility function in client/src/lib/tokenUtils.ts
  - Logic: if collection !== 'Token', return collection; else return type
  - Integrated into tokens.ts store's toFungibleTokenDisplay() for default name/symbol
  - Integrated into nfts.ts store's toNFTDisplay() for default name/symbol
  - When metadata is available, metadata name/symbol takes precedence
  - When metadata is not available, getTokenIdentifier provides the fallback
- Files changed:
  - client/src/lib/tokenUtils.ts (new)
  - client/__tests__/lib/tokenUtils.spec.ts (new)
  - client/src/stores/tokens.ts (import and use getTokenIdentifier)
  - client/src/stores/nfts.ts (import and use getTokenIdentifier)
  - client/__tests__/stores/nfts.spec.ts (update test expectations for collection-based names)
  - ISSUES_FIX_PLAN.json (marked token-identification as passed)
  - manualTestingRequired.txt (added token-identification testing checklist)
- GalaChain tools used: None
- Tests: All 1208 tests pass (1150 client + 58 server)
- Learnings for future iterations:
  - Token identification logic: use collection if not 'Token', otherwise use type
  - This convention exists because many tokens use 'Token' as a generic collection name
  - Custom collections often have more meaningful names that should be displayed
  - The utility function is reusable across both FT and NFT contexts
  - Metadata name/symbol always takes precedence when available
---


## Iteration 35 - token-burn-option (Issue Fix)
- What was implemented:
  - Updated canBurn logic so users can burn tokens they own (have balance > 0) OR tokens they have burn authority for
  - Previously canBurn was only true when user had burn allowance
  - The logic change is: canBurnToken = hasBalance || hasBurnAllowance
  - Updated display.ts comment to clarify canBurn now means "can burn (owns OR has authority)"
  - Added comprehensive unit tests for the new canBurn logic
- Files changed:
  - client/src/stores/tokens.ts (updated toFungibleTokenDisplay canBurn logic)
  - shared/types/display.ts (updated canBurn comment)
  - client/__tests__/stores/tokens.spec.ts (new - 7 tests for canBurn logic)
  - ISSUES_FIX_PLAN.json (marked token-burn-option as passed)
  - manualTestingRequired.txt (added token-burn-option checklist)
- GalaChain tools used: None
- Tests: All 1215 tests pass (1157 client + 58 server)
- Learnings for future iterations:
  - GalaChain allows users to burn their own tokens without special burn authority
  - The Burn button visibility should be based on ownership, not just authority
  - canMint remains authority-only (users can't mint without mint allowance)
  - canBurn differs from canMint - users can always burn what they own
---

## Iteration - allowances-bidirectional
- What was implemented:
  - Updated tokens store with allowancesReceived and allowancesGranted separate arrays
  - Added computed allowances property combining both for backward compatibility
  - Updated useFungibleTokens composable to expose allowancesReceived and allowancesGranted
  - Updated AllowanceList.vue with viewMode prop ('received' or 'granted')
  - AllowanceList dynamically shows 'From:' or 'To:' based on viewMode
  - Updated TokensView.vue with Received/Granted sub-tabs under Allowances
  - Added API limitation notice on Granted tab explaining feature not yet available
  - Updated all tests using allowances: to allowancesReceived:
  - Added bidirectional allowances tests to tokens.spec.ts
- Files changed:
  - client/src/stores/tokens.ts (allowancesReceived, allowancesGranted, setAllowancesReceived, setAllowancesGranted)
  - client/src/composables/useFungibleTokens.ts (expose allowancesReceived, allowancesGranted)
  - client/src/components/tokens/AllowanceList.vue (viewMode prop, partyLabel computed, getPartyAddress)
  - client/src/views/TokensView.vue (Received/Granted sub-tabs, API limitation notice)
  - client/__tests__/stores/tokens.spec.ts (bidirectional allowance tests)
  - client/__tests__/composables/useTokenAuthority.spec.ts (updated to use allowancesReceived)
  - client/__tests__/composables/useNFTMintAuthority.spec.ts (updated to use allowancesReceived)
- GalaChain API finding:
  - FetchAllowancesDto requires grantedTo as a REQUIRED parameter
  - Cannot query allowances granted BY user without specifying who they were granted TO
  - Infrastructure is ready for when API adds support
- Tests: All 1217 tests pass (1159 client + 58 server)
- Learnings for future iterations:
  - Pinia computed properties cannot be directly patched in tests - patch the underlying refs
  - GalaChain API requires grantedTo for FetchAllowances - grantedBy is optional filter
  - Plan for API limitations with informative UI messages rather than hiding features
---
